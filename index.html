<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Googleログイン</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div id="g_id_onload"
         data-client_id="551345592352-gtvhlugj0k7j88l5kr6kouejj3q61uf0.apps.googleusercontent.com"
         data-callback="handleCredentialResponse"
         data-auto_prompt="false">
    </div>
    <div class="g_id_signin" data-type="standard"></div>

    <div id="user-info">
        <p>ログイン情報：</p>
        <p><strong>名前:</strong> <span id="user-name"></span></p>
        <p><strong>メール:</strong> <span id="user-email"></span></p>
        <p><strong>アイコン:</strong><br> <img id="user-icon" width="100" height="100" style="border-radius:50%;" /></p>
    </div>

    <script>
        // 認証後のコールバック関数
        function handleCredentialResponse(response) {
            const jwt = response.credential;
            const userInfo = parseJwt(jwt);

            // ユーザー情報を取得して表示
            document.getElementById("user-name").textContent = userInfo.name;
            document.getElementById("user-email").textContent = userInfo.email;
            document.getElementById("user-icon").src = userInfo.picture;
        }

        // JWTデコード関数（IDトークン解析）
        function parseJwt(token) {
            var base64Url = token.split('.')[1];
            var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }
    </script>
</body>
</html>
